<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Tracker Block Test</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { font-family: -apple-system, system-ui, Helvetica, Arial, sans-serif; margin: 2rem; }
    .ok { color: #0a7f00; }
    .bad { color: #b00020; }
    code { background: #f4f4f6; padding: 0.25rem 0.4rem; border-radius: 4px; }
  </style>
</head>
<body>
  <h1>Tracker Block Test</h1>
  <p>This page attempts to load a known tracker and a safe script. Check the console for results.</p>

  <h2>1) Known tracker script (should be <span class="bad">BLOCKED</span>)</h2>
  <p>Source: <code>https://s0.2mdn.net/instream/html5/ima3.js</code></p>

  <h2>2) Safe script (should <span class="ok">LOAD</span>)</h2>
  <p>Inline/local script to confirm the page still works.</p>

  <h2>3) Optional tracker pixel (should be <span class="bad">BLOCKED</span>)</h2>
  <p>Loads an image from an ad/analytics domain (won’t break the page if blocked).</p>

  <script>
    function log(msg, cls) {
      const p = document.createElement('p');
      p.textContent = msg;
      if (cls) p.className = cls;
      document.body.appendChild(p);
      console[cls === 'bad' ? 'error' : 'log'](msg);
    }

    // 1) Try to load a known tracker (2mdn.net -> default "block"; ima3.js is in the list)
    // TDS entry shows default:block and a rule for /instream/html5/ima3.js
    // https://staticcdn.duckduckgo.com/trackerblocking/v2.1/tds.json
    (function loadBlockedTracker() {
      const s = document.createElement('script');
      s.src = "https://s0.2mdn.net/instream/html5/ima3.js";
      s.onload = () => log("Tracker script LOADED (unexpected) – blocking may be off.", "bad");
      s.onerror = () => log("Tracker script BLOCKED as expected (2mdn.net).", "ok");
      document.head.appendChild(s);
    })();

    // 2) Load a safe local script (inline) to prove JS still runs
    (function safeScript() {
      log("Safe inline script executed.", "ok");
    })();

    // 3) Optional: pixel from another blocked domain (e.g., 3lift.com default:block)
    (function pixelTest() {
      const img = new Image();
      img.src = "https://px.3lift.com/img.gif?test=1"; // typical tracker pixel style URL
      img.onload = () => log("Tracker pixel LOADED (unexpected) – blocking may be off.", "bad");
      img.onerror = () => log("Tracker pixel BLOCKED as expected (3lift.com).", "ok");
    })();
  </script>
</body>
</html>
